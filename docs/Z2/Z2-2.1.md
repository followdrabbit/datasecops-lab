# 2.1 Raw Zone (Object Storage Seguro e Governado)

A **Raw Zone** da Z2 é o **primeiro lugar onde os dados “aprovados” pela Z1 são persistidos**.

Ela é:

* **Bruta**: mantém o formato o mais próximo possível da fonte.
* **Restrita**: acesso mínimo, fortemente controlado.
* **Auditável**: tudo o que entra é rastreável até a origem.
* **Base forense e histórica**: usada como linha do tempo de “como o dado chegou”, não como playground.

Pensa nela como:

> “O cofre de entrada oficial da plataforma de dados/ML. Tudo que passa por Z1 e merece ser guardado, cai aqui.”

Não é “pasta solta de CSV”. É uma **zona com regras claras**.

---

## 2.1.1 Princípios da Raw Zone

1. **Somente escrita via pipelines oficiais**

   * Quem grava aqui:

     * conectores da Z1 (ETL, serviços internos, jobs Airflow, consumidores de fila),
     * usando **service accounts** e segredos do Vault.
   * Nunca:

     * app externo, script aleatório, notebook do analista.

2. **Formato próximo da origem, não “embelezado”**

   * O objetivo é preservar:

     * estrutura original,
     * campos,
     * ordem,
     * erros inclusive (desde que tenham passado pela higiene mínima).
   * Transformações pesadas, limpeza sem lastro, enriquecimento → só em Z3 (Curated).

3. **Somente leitura para atores autorizados**

   * leitura tipicamente:

     * por times de plataforma/engenharia de dados,
     * por pipelines de curadoria (Z3),
     * por processos de auditoria/investigação.
   * usuários finais, BI, notebooks soltos → devem olhar para Z3/Z7, não direto para Z2.

4. **Reprodutibilidade & Forense**

   * Se alguém perguntar:

     * “Com que dados esse modelo foi treinado em março?”
   * Você aponta:

     * “Com esses arquivos/lotes específicos da Raw Zone, com esses hashes, vindos dessas fontes Z1.”

---

## 2.1.2 Organização lógica (nomeação, pastas, partições)

Para não virar caos, a Raw Zone deve ser organizada com padrão.

Um modelo simples (ajustável ao lab):

```text
raw/
  <source_system>/
    <domain>/             # opcional: fraude, risco, canais, etc.
      <dataset>/          # opcional: transacoes, eventos, kyc_docs
        year=<ano>/
          month=<mm>/
            day=<dd>/
              <arquivo>.parquet
              <arquivo>.json
              <arquivo>.csv
```

Exemplos:

* `raw/core-transacoes/transacoes/year=2025/month=11/day=10/part-0001.snappy.parquet`
* `raw/parceiro-bureau-x/score_credito/year=2025/month=11/day=09/lote_001.csv`
* `raw/open-finance/extrato/year=2025/month=11/day=08/ofx_dump_001.xml`

Características:

* **Agrupado por fonte (source_system)**:

  * conecta diretamente com Z0/Z1.
* **Particionado por tempo**:

  * facilita leitura incremental, auditoria e limpeza.
* **Dataset/domínio bem identificado**:

  * evita mistura acidental de dados diferentes no mesmo lugar.

---

## 2.1.3 Metadados mínimos obrigatórios

Cada arquivo/objeto na Raw Zone deve ter metadados que permitam responder:

> “Quem colocou isso aqui, quando, a partir de qual endpoint e com qual status?”

Metadados típicos (no nome, no objeto ou em catálogo):

* `source_system` (ex.: `core-transacoes`, `parceiro-x`),
* `ingestion_pipeline` (ex.: `airflow_dag_x`, `service_ingest_y`),
* `ingestion_time` (timestamp de chegada),
* `schema_version` (quando aplicável),
* `hash` (ex.: SHA-256 do arquivo),
* `classification` (sensível / PII / confidencial / público-interno).

Esses metadados:

* conectam Z2 com os logs de Z1,
* são base para auditoria, troubleshooting, reprocessamento e rastreabilidade de modelos.

---

## 2.1.4 Permissões e perfis (quem pode fazer o quê na Raw Zone)

A Raw Zone é **restricted** por definição.

Padrão recomendado:

* **Service accounts de ingestão (Z1 → Z2)**:

  * Permissão: `write` nos buckets/prefixos específicos que operam.
  * Sem `list` amplo, sem `delete` irrestrito.
* **Pipelines de curadoria (Z3)**:

  * Permissão: `read` seletivo em datasets necessários,
  * gravam saída em zonas curadas, não sobrescrevem Raw.
* **Usuários humanos (engenharia de dados / segurança)**:

  * Em produção:

    * acesso somente sob perfil específico,
    * via bastion/jump ou ferramentas de observabilidade,
    * sempre logado e excepcional.
* **Ferramentas de auditoria/forense**:

  * `read` controlado,
  * nunca `write` direto.

Resumo forte pra usar no doc/entrevista:

> Raw não é pasta de “data scientist fuçar”. É camada de confiança da plataforma.

---

## 2.1.5 Relação com criptografia, rede e IAM

O item 2.1 se conecta diretamente com os seguintes pontos (mesmo que detalhados depois):

* **Criptografia (2.2)**:

  * toda Raw Zone criptografada em repouso.
* **Network Isolation (2.3)**:

  * storage exposto só em rede interna / endpoints privados.
* **IAM (2.4)**:

  * controle fino por bucket/prefixo/service account.

Aqui você mostra que **não existe Raw Zone “jogada na mesma rede dos apps web”**.

---

## 2.1.6 Raw vs Staging vs Quarentena

É importante separar mentalmente:

* **Staging**:

  * área temporária (pode até ser fora da Raw) onde os dados recém recebidos e ainda em avaliação ficam.
  * dados podem ser descartados se falharem regras.
* **Quarentena**:

  * área isolada para arquivos suspeitos (malware, schema zoado, etc.),
  * acesso super restrito.
* **Raw Zone (Z2)**:

  * só recebe:

    * o que passou por Z1 + checagens mínimas,
    * o que foi aprovado pelo pipeline de ingestão oficial.

Essa separação evita:

* poluir Raw com lixo ou suspeito,
* misturar conteúdo forense/suspeito com dado operacional.

---

## 2.1.7 Como isso aparece no Lab (MLOps Security Lab)

No lab, a Raw Zone pode ser:

* **MinIO** rodando na VPS:

  * acessível só pela rede interna (docker network interna),
  * com usuário/senha/keys gerenciadas pelo Vault.
* Os **DAGs do Airflow**:

  * recebem dados aprovados,
  * gravam em `raw/...` com particionamento por data e metadados.
* Os serviços de curadoria:

  * leem da Raw com credenciais próprias,
  * geram Z3 (curated) como próxima camada segura.

Você mostra, na prática:

* arquivo chegando via Z1,
* registrado em Raw com:

  * origem,
  * horário,
  * hash,
  * etc.

E reforça a mensagem:

> “Se algum dado usado em modelo não existe na Raw Zone com trilha de proveniência, esse caminho está errado.”
